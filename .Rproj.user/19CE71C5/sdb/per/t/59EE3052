{
    "contents" : "library(plotrix)\nlibrary(lmtest)\nlibrary(qpcR)\nlibrary(nlstools)\n\nrequire(qpcR) \nrequire(rpanel)\nrequire(lattice)\nrequire(latticeExtra)\nrequire(grid)\nrequire(lattice)\nrequire(RColorBrewer)\nlibrary(ggplot2)\n\nlibrary(\"lattice\") \nlibrary(latticeExtra) # for mergedTrellisLegendGrob()\n\nsource(\"lib/nlsResiduals.r\")\nsource(\"lib/ridiculas_functions.r\")\nsource(\"lib/msFunc.r\")\n\n\n# Função principal para a geração dos gráficos\nrun_all <- function(modelo, dados){\n  \n  # vendo a superfície ajustada\n  args(panel.3d.contour)\n  body(panel.3d.contour)\n  \n  fcc_r    <- M.predict(modelo, dados$EVA, dados$FIBRA)\n  fcc      <- dados$TRACAO\n  \n  residuos <- fcc-fcc_r\n  \n  reducao_res <- (M.predict(modelo, 0.25, 0)-M.predict(modelo, 0, 0))/M.predict(modelo, 0, 0)\n  print(summary(modelo))\n  print(paste(\"R^2 -> \", Q.R2(fcc_r, fcc)))\n  print(paste(\"SSE -> \", Q.SSE(fcc_r, fcc)))\n  press <- Q.PRESS(modelo, 'TRACAO', fcc0, dados)\n  print(paste(\"PRESS -> \", press))\n  print(paste(\"R^2 PRESS -> \", Q.R2Pred(fcc, press)))\n  \n  ## TEstes de hipotese\n  \n  #Shapiro-wilk\n  print(shapiro.test(residuals(modelo)))\n  \n  \n  #Durbin-Watson test\n  print(dwtest(modelo))\n  \n  #Breusch-Pagan test\n  print(bptest(modelo))\n\n  \n  ## PLOT  ##\n  \n  # Residuo\n  PrintResiduoNormalizado(pathImagens(\"tracao\", \"residuo_normalizado.png\"), \n                          modelo, residuos, fcc_r)\n  \n  PrintResiduoVarReg(pathImagens(\"tracao\", \"residuo.png\"),\n                     \"Resistência à Tração\", residuos, dados$TRACAO)\n  \n  \n  PrintResiduoVarReg(pathImagens(\"tracao\", \"residuo_eva.png\"),\n                     \"EVA (%)\", residuos, dados$EVA)\n  \n  PrintResiduoVarReg(pathImagens(\"tracao\", \"residuo_fibra.png\"), \n                     \"Fibras (%)\", residuos, dados$FIBRA)\n  \n  # Funcao\n  printModeloAjuste(pathImagens(\"tracao\", \"modelo_ajuste.png\"), \n                    modelo, fcc_r, fcc, ylim=c(1,4), xlim=c(1,4))\n  \n  # Graficos 3d\n  lim_xyz <- c(0.26, 0.021, 0, 4)\n  lbl_xyz <- c(\"EVA (%)\", \"Fibra (%)\", \"Resistência à Tra\\u{E7}\\u{E3}o (MPa)\")\n  \n  print3DFunc(pathImagens(\"tracao\", \"3d_1.png\"), \n              modelo, \n              list(z=-50, x=-70, y=0), \n              lbl_xyz,  \n              lim_xyz)\n  \n  print3DFunc(pathImagens(\"tracao\", \"3d_2.png\"), \n              modelo, \n              list(z=-120, x=-70, y=0), \n              lbl_xyz,  \n              lim_xyz)\n  \n  # Graficos 3d EFICIENCIA\n  print3DEfici(pathImagens(\"tracao\", \"3d_ef.png\"), \n               modelo, \n               list(z=140, x=-70, y=-00), \n               c(\"EVA (%)\", \"Fibra (%)\", \"Eficiência (%)\"),  \n               c(0.26, 0.021, 0, 60))\n  \n  # Curvas de Nível\n  printCurvasNivelFunc(pathImagens(\"tracao\", \"curva_nivel.png\"), modelo, lbl_xyz,lim_xyz)\n  \n  # Max resistencia Barra\n  maxFib <- optimizeFibModelo(modelo, iEva=seq(0.05, 0.25, by=0.05), TRUE)\n  printMaxResistenciaFibra(pathImagens(\"tracao\", \"barra_max.png\"), maxFib, lbl_xyz[3])\n  \n  # Max resistencia Evolucao\n  maxFib <- optimizeFibModelo(modelo, iEva=seq(0,0.25, by=0.005), TRUE)\n  printMaxResistenciaFibraLine(pathImagens(\"tracao\", \"eva_max.png\"), maxFib, lbl_xyz[3])\n  \n  # Resistencia por eva, com 3 curvas 0,1,2 % fibra\n  printResistenciaFibraLinha(pathImagens(\"tracao\", \"eva_0_1_2.png\"), modelo, lbl_xyz[3])\n  \n  # Resistencia por fibra, com 3 curvas 5, 15, 25 % fibra\n  printResistenciaEVALinha(pathImagens(\"tracao\", \"fibra_5_15_25.png\"), modelo, lbl_xyz[3])\n  \n}\n\n\n### DADOS\ndados <- read.table(file=\"dados.txt\", header=T, sep=\" \")\n\n## Filtra apenas o EVA fino\ndados <- dados[dados$TIPO!='EG15'&dados$TIPO!='1EG15',]\n\n## Dados de compressão do CR (Concreto de Referencia)\nfcc0  <- dados[dados$EVA==0&dados$FIBRA==0,]$TRACAO\n\n## Dados de Compressao \nfcc   <- dados$TRACAO\n\n## Calcula o y da regressao\ny     <- fcc-fcc0\n\n\n######################### Rergessao  #########################\n\n### MODELO 1 COMPLETO\nmodelo      <-lm(y~0+EVA+FIBRA+EVA:FIBRA+I(EVA^2)+I(FIBRA^2),data=dados) \nmodelo$fcc0 <- fcc0\n\nsummary(modelo)\nanova(modelo)\n\nfcc_r    <- M.predict(modelo, dados$EVA, dados$FIBRA)\nrun_all(modelo, dados)\n\n\n### MODELO 1 RESUMO\nmodelo      <-lm(y~0+EVA+FIBRA+EVA:FIBRA,data=dados) \nmodelo$fcc0 <- fcc0\n\nsummary(modelo)\nanova(modelo)\n\nfcc_r    <- M.predict(modelo, dados$EVA, dados$FIBRA)\nrun_all(modelo, dados)\n",
    "created" : 1470873104870.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "2592478065",
    "id" : "59EE3052",
    "lastKnownWriteTime" : 1478430697,
    "path" : "D:/Dropbox/Mestrado/Projeto Marlesson/Dissertacao/Algoritimos R/Concreto/main_trac.r",
    "project_path" : "main_trac.r",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}